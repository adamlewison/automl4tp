<!DOCTYPE HTML>
<!--
	Dimension by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
    James
-->
<html> 
<head>
    <title>Evolutionary Algorithms for Automated Machine Learning</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport"/>
    <link href="assets/css/main.css" rel="stylesheet"/>
    <noscript>
        <link href="assets/css/noscript.css" rel="stylesheet"/>
    </noscript>
</head>
<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper">

    <!-- Header -->
    <header id="header">
        <div class="logo">
            <span class="icon fa-chart-line"></span>
        </div>
        <div class="content">
            <div class="inner">
                <h1>
					Evolutionary Algorithms for Automated Machine Learning
				</h1>
                <p>
					AutoML aims to automate the entire machine learning pipeline. In our research, we focused on hyper-parameter optimisation, a sub-domain of AutoML. Our research focuses on evaluating the performance of evolutionary algorithms for the task of AutoML in the context of trend prediction in time series data. Our research analysed the performance of differential evolution and a genetic algorithm against random search for the task of AutoML.
				</p>
                <p> <i> Project Supervised By: Deshendran Moodley</i> </p>

            </div>
        </div>
        <nav>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#goals">Goals</a></li>
                <li><a href="#results">Results</a></li>
                <li><a href="#docs">Docs</a></li>
                <!--<li><a href="#elements">Elements</a></li>-->
            </ul>
        </nav>
    </header>

    <!-- Main -->
    <div id="main">

        <!-- Intro -->
        <article id="overview">

            <h2 class="major">Overview</h2>

            <!--
            <span class="image main"><img alt="" src="images/pic01.jpg"/></span>
            -->

            <h3>Data Pre-Processing</h3>
            <p>
                We obtained time series data of the daily prices of three various financial equities.
                We obtained this data from <a href="https://finance.yahoo.com">finance.yahoo.com</a>.
            </p>
            <span class="image main">
                <img alt="" src="images/trend-lines.jpg"/>
                <i>https://www.forex.academy</i>
            </span>
            <p>
                Similar to the image above,
                we systematically converted this raw time series data into a sequence of trend lines for each financial equity.
            </p>
            <p>
                Since we are concerned with teaching a machine learning model to predict the next trend it is clear that we are dealing with a supervised learning problem.
                Thus we needed to construct our data (the sequence of trend lines) into a collection of input-output pairs, otherwise known as feature-label pairs.
                To this end we used a standard sliding window algorithm. In order to construct a single input-output pair the algorithm groups trend lines into a matrix of four trend lines and associates a label where the label is the next trend line.
                The algorithm does this for the entire data-set as depicted in the picture below.
            </p>
            <span class="image main">
                <img alt="" src="images/sliding-window.png"/>
                This algorithm groups trend lines (T) into a matrix of four trend lines (A) and associates a label (B) where the label is the next trend line.
            </span>

            <h3>Machine Learning</h3>
            <span class="image main">
                <img alt="" src="images/nn1.png"/>
                <i>http://brainstormingbox.org</i>
            </span>
            <p>
                As described above, we are dealing with a supervised learning problem. In order to train the weights of the machine learning model we use 60% of the trend lines constructed (explained above).
                We then pass the four previous trend lines into a machine learning model and the output of the machine learning model is the predicted next trend line.
            </p>

            <h3>Automated Machine Learning</h3>
            <p>
                We applied a subset of Automated Machine Learning to this task known as Combined Algorithm and Hyper-Parameter Selection (CASH).
                That is, for a pre-defined selection of machine learning algorithms and a selected range of their respective hyper-parameters - we try to find the combination of algorithm and hyper-parameters that best predicts the next trend line.
            </p>
            <p>
                This CASH problem can be seen as a black-box optimization problem, i.e. there is a large search space, we are trying to find the location in this search space which minimises the objective function.
                In our case the objective function used is the combined (Trend Line Length and Trend Line Gradient) mean squared error of actual observed trend lines versus predicted trend lines over a validation set (The validation set used is a subset of 20% of the trend lines constructed above).
            </p>

            <h3>Evolutionary Optimization Algorithms</h3>

            <p>
                Now that we have set up a large search space and an objective function over that search space - we are left with a difficult optimization problem!
            </p>

            <span class="image main">
                <img alt="" src="images/Ackley.gif"/>
                <i>Pablormier - https://pablormier.github.io/2017/09/05/a-tutorial-on-differential-evolution-with-python</i>
            </span>

            <p>
                A class of optimization techniques known as Evolutionary Optimization Algorithms are a promising candidate to perform very well for this task.
                The main concept of an Evolutionary Optimization Algorithm is <i>generations</i>. A generation contains a population of members where each member represents a position in the search space.
                Through variations of mutation and selection techniques - a new generation is born - where the new generation is supposedly an improved version compared to its parent generation.
                In this way the algorithm attempts to find the best position.
            </p>

            <p>
                The focus of our research is the exploration of two Evolutionary Algorithms in particular, namely: Genetic Algorithms and Differential Evolution.
            </p>
        </article>

        <!-- Work -->
        <article id="goals">
            <h2 class="major">Goals</h2>
            <span class="image main"><img alt="" src="images/goal.jpg"/></span>
            <p> The focus of this research was framed in a single research objective which we set out to acheive. Our objective was to analyse and compare the performance of evolutionary algorithms for hyperparameters optimisation in neural network models given the context of trend prediction in time series data.</p>
            <p>Thus, we set out our research to answer two research questions formulated from the above objective. Firstly, can evolutionary algorithms be used to effectively solve the hyperparameter optimisation problem when compared to a conventional method - random search in this case - in terms of minimising the validation mean squared error of the model? Secondly, how well do the models produced by the evolutionary algorithm AutoML method perform in the task of trend prediction, using the model's test mean square error as the evaluation metric? </p>
            <h3> Genetic Algorithm Objectives </h3>
            <p> The experiments regarding genetic algorithms were evaluated further with the objective of understanding how well the two algorithms (genetic algorithm and random search) perform under both high and low computational budgets. </p>

            <h3> Differential Evolution Objectives </h3>
            <p>
                The experiments regarding Differential Evolution had two primary objectives.
                The first objective was to study the effect of change in the control-parameters of the Differential Evolution algorithm in order to optimize its performance.
                The second objective was to compare the performance (in terms of speed of minimisation and ability to learn the underlying pattern of the data) of differential evolution to an unintelligent random search and to another state of the art evolutionary algorithm.
            </p>
        </article>

        <!-- About -->
        <article id="results">
            <h2 class="major">Results</h2>

            <p> In order to acheive the objectives outlined at the beginning of our research, we performed a number of different experiments. We implemented the experiments using Python along with PyTorch for the neural networks and PyMoo for the evolutionary algorithm. We evaluated the evolutionary algorithms against a hand-made random search method. Below are the details and the results pertaining to each evolutionary algorithm under evaluation. </p>

            <h3 class="major">Genetic Algorithm</h3>
            <p> In order to evaluate the performance of the genetic algorithm against the random search algorithm, two sets of experiments were performed. We performed experiments with both high and low computational budgets in order to evaluate the AutoML algorithms under different computational circumstances. These experiments were performed on two datasets - the closing prices of the NYSE and NASDAQ. Each of these experiments were run 8 times in order to have robust results. We evaluate the performance of the genetic algorithm and random search by means of the validation MSE on two different neural network models - an LSTM and an MLP.  </p>
            <h4> Results </h4>
            <span class="image main">
                <img alt="" src="images/nasd.png"/>
                Results from high budget experiments on the NASDAQ dataset. Lower MSE is better. 
            </span>
            <span class="image main">
                <img alt="" src="images/l_nas.png"/>
                Results from low budget experiments on the NASDAQ dataset. Lower MSE is better. 
            </span>
            <p> From the first plot, we can see that the genetic algorithm outperforms the random search algorithm, on average, for both the MLP and the LSTM in the high budget experiments on the NASDAQ dataset. This is not the case for the low budgets experiments where random search outperforms genetic algorithm on the LSTM. It is also important to note the lower variability of the genetic algorithm experiments on the high budget experiments, but the opposite case in the low budget experiments. </p>
            <span class="image main">
                <img alt="" src="images/ny.png"/>
                Results from high budget experiments on the NYSE dataset. Lower MSE is better. 
            </span>
            
            <span class="image main">
                <img alt="" src="images/low_ny.png"/>
                Results from low budget experiments on the NYSE dataset. Lower MSE is better.
            </span>
            <p> From the above two plots for the experiments on the NYSE dataset, we can see that the genetic algorithm outperforms the random search algorithm, on average, for both the MLP and the LSTM. This is the case for both the high and low budget experiments. However, here the variability is varied betweem the two AutoML methods.  </p>
            <h4> Conclusions </h4>
            <p> From the results of the experiments, we found that a genetic algorithm can, in general, outperform a simple random search algorithm for the task of hyperparameter optimisation given both high and low computational budgets. However, the time to terminate for the genetic algorithm was significantly longer than random search.  </p>
            <p> The performance of the models selected by the AutoML algorithms were poor on out-of-sample data. This was determined to be due to the nature of our validation process, rather than the autoML techniques themselves.  </p>
            <h3 class="major">Differential Evolution</h3>
            <p>
                In line with Objective one concerning Differential Evolution - we found that a population size of 20 performed very well.
                By opting to choose a lower a population size we were able to still have many generations within our budget.
            </p>

            <span class="image main">
                <img alt="" src="images/pop_size_nyse.png"/>
                This image clearly depicts the drop in mean squared error with a validation size of 20.
            </span>

            <p>
                However, as shown in the picture below, no obvious improvement could be found by tweaking the F and CR control-parameters.
            </p>

            <span class="image main">
                <img alt="" src="images/heat_alldata_20.png"/>
                This image clearly depicts the drop in mean squared error with a validation size of 20.
            </span>

            After selecting optimal control-parameters, Differential Evolution was evaluated in how quickly it was able to minimize the objective in comparison to a random search and a different state-of-the-art evolutionary algorithm.

            As can be seen in the image below, Differential Evolution showed to be more effective than a completely random search in efficiently minimizing the objective function.
            <span class="image main">
                <img alt="" src="images/cv_nyse_rnd.png"/>
            </span>

            However, when the final models were evaluated on a set of out-of-sample data, the model found by the Differential Evolution algorithm was not superior to that found by Pattern Search or even the unintelligent random search for any of the data sets.
        </article>

		<!-- About -->
		<article id="docs">
			<h2 class="major">Docs</h2>
			<section style="margin-bottom: 50px">
				<h3 class="major">Literature Reviews</h3>
				<ul>
					<li><a href="files/adam_litreview.pdf">Adam's</a></li>
					<li><a href="files/james_lit.pdf">James's</a></li>
				</ul>
			</section>

			<section style="margin-bottom: 50px">
				<h3 class="major">Project Proposal</h3>
				<ul>
					<li><a href="files/proposal.pdf">Team</a></li>
				</ul>
			</section>

			<section style="margin-bottom: 50px">
				<h3 class="major">Final Project</h3>
				<ul>
					<li><a href="files/adam_final.pdf">Adam's</a></li>
					<li><a href="files/james_final.pdf">James's</a></li>
				</ul>
			</section>

			<section style="margin-bottom: 50px">
				<h3 class="major">Poster</h3>
				<ul>
					<li><a href="files/poster.pdf">Team</a></li>
				</ul>
			</section>
		</article>

        <!-- Contact -->
        <article id="contact">
            <h2 class="major">Contact</h2>

			<section style="margin-bottom: 50px">
				<h3 class="major">Adam Lewison</h3>
				<ul class="icons">
					<li><a class="icon fa-envelope" href="mailto:LWSADA002@myuct.ac.za"> <span class="label">Email</span></a></li> <a href=mailto:LWSADA002@myuct.ac.za>LWSADA002@myuct.ac.za</a>
				</ul>
			</section>
			<section>
				<h3 class="major">James Taljard</h3>
				<ul class="icons">
					<li><a class="icon fa-envelope" href="mailto:TLJJAM001@myuct.ac.za"><span class="label">Email</span></a></li> <a href=mailto:TLJJAM001@myuct.ac.za>TLJJAM001@myuct.ac.za</a>
				</ul>
				<h4>
					Department of Computer Science
				</h4>
				<h4>
					University Of Cape Town
				</h4>
			</section>
			<!--
            <form action="#" method="post">
                <div class="fields">
                    <div class="field half">
                        <label for="name">Name</label>
                        <input id="name" name="name" type="text"/>
                    </div>
                    <div class="field half">
                        <label for="email">Email</label>
                        <input id="email" name="email" type="text"/>
                    </div>
                    <div class="field">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" rows="4"></textarea>
                    </div>
                </div>
                <ul class="actions">
                    <li><input class="primary" type="submit" value="Send Message"/></li>
                    <li><input type="reset" value="Reset"/></li>
                </ul>
            </form>
            <ul class="icons">
                <li><a class="icon brands fa-twitter" href="#"><span class="label">Twitter</span></a></li>
                <li><a class="icon brands fa-facebook-f" href="#"><span class="label">Facebook</span></a></li>
                <li><a class="icon brands fa-instagram" href="#"><span class="label">Instagram</span></a></li>
                <li><a class="icon brands fa-github" href="#"><span class="label">GitHub</span></a></li>
            </ul>
            -->

        </article>

        <!-- Elements -->
        <article id="elements">
            <h2 class="major">Elements</h2>

            <section>
                <h3 class="major">Text</h3>
                <p>This is <b>bold</b> and this is <strong>strong</strong>. This is <i>italic</i> and this is <em>emphasized</em>.
                    This is <sup>superscript</sup> text and this is <sub>subscript</sub> text.
                    This is <u>underlined</u> and this is code: <code>for (;;) { ... }</code>. Finally, <a href="#">this
                        is a link</a>.</p>
                <hr/>
                <h2>Heading Level 2</h2>
                <h3>Heading Level 3</h3>
                <h4>Heading Level 4</h4>
                <h5>Heading Level 5</h5>
                <h6>Heading Level 6</h6>
                <hr/>
                <h4>Blockquote</h4>
                <blockquote>Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget tempus
                    euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis
                    volutpat ac adipiscing accumsan faucibus. Vestibulum ante ipsum primis in faucibus lorem ipsum dolor
                    sit amet nullam adipiscing eu felis.
                </blockquote>
                <h4>Preformatted</h4>
                <pre><code>i = 0;

while (!deck.isInOrder()) {
    print 'Iteration ' + i;
    deck.shuffle();
    i++;
}

print 'It took ' + i + ' iterations to sort the deck.';</code></pre>
            </section>

            <section>
                <h3 class="major">Lists</h3>

                <h4>Unordered</h4>
                <ul>
                    <li>Dolor pulvinar etiam.</li>
                    <li>Sagittis adipiscing.</li>
                    <li>Felis enim feugiat.</li>
                </ul>

                <h4>Alternate</h4>
                <ul class="alt">
                    <li>Dolor pulvinar etiam.</li>
                    <li>Sagittis adipiscing.</li>
                    <li>Felis enim feugiat.</li>
                </ul>

                <h4>Ordered</h4>
                <ol>
                    <li>Dolor pulvinar etiam.</li>
                    <li>Etiam vel felis viverra.</li>
                    <li>Felis enim feugiat.</li>
                    <li>Dolor pulvinar etiam.</li>
                    <li>Etiam vel felis lorem.</li>
                    <li>Felis enim et feugiat.</li>
                </ol>
                <h4>Icons</h4>
                <ul class="icons">
                    <li><a class="icon brands fa-twitter" href="#"><span class="label">Twitter</span></a></li>
                    <li><a class="icon brands fa-facebook-f" href="#"><span class="label">Facebook</span></a></li>
                    <li><a class="icon brands fa-instagram" href="#"><span class="label">Instagram</span></a></li>
                    <li><a class="icon brands fa-github" href="#"><span class="label">Github</span></a></li>
                </ul>

                <h4>Actions</h4>
                <ul class="actions">
                    <li><a class="button primary" href="#">Default</a></li>
                    <li><a class="button" href="#">Default</a></li>
                </ul>
                <ul class="actions stacked">
                    <li><a class="button primary" href="#">Default</a></li>
                    <li><a class="button" href="#">Default</a></li>
                </ul>
            </section>

            <section>
                <h3 class="major">Table</h3>
                <h4>Default</h4>
                <div class="table-wrapper">
                    <table>
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Price</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Item One</td>
                            <td>Ante turpis integer aliquet porttitor.</td>
                            <td>29.99</td>
                        </tr>
                        <tr>
                            <td>Item Two</td>
                            <td>Vis ac commodo adipiscing arcu aliquet.</td>
                            <td>19.99</td>
                        </tr>
                        <tr>
                            <td>Item Three</td>
                            <td> Morbi faucibus arcu accumsan lorem.</td>
                            <td>29.99</td>
                        </tr>
                        <tr>
                            <td>Item Four</td>
                            <td>Vitae integer tempus condimentum.</td>
                            <td>19.99</td>
                        </tr>
                        <tr>
                            <td>Item Five</td>
                            <td>Ante turpis integer aliquet porttitor.</td>
                            <td>29.99</td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td colspan="2"></td>
                            <td>100.00</td>
                        </tr>
                        </tfoot>
                    </table>
                </div>

                <h4>Alternate</h4>
                <div class="table-wrapper">
                    <table class="alt">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Price</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Item One</td>
                            <td>Ante turpis integer aliquet porttitor.</td>
                            <td>29.99</td>
                        </tr>
                        <tr>
                            <td>Item Two</td>
                            <td>Vis ac commodo adipiscing arcu aliquet.</td>
                            <td>19.99</td>
                        </tr>
                        <tr>
                            <td>Item Three</td>
                            <td> Morbi faucibus arcu accumsan lorem.</td>
                            <td>29.99</td>
                        </tr>
                        <tr>
                            <td>Item Four</td>
                            <td>Vitae integer tempus condimentum.</td>
                            <td>19.99</td>
                        </tr>
                        <tr>
                            <td>Item Five</td>
                            <td>Ante turpis integer aliquet porttitor.</td>
                            <td>29.99</td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td colspan="2"></td>
                            <td>100.00</td>
                        </tr>
                        </tfoot>
                    </table>
                </div>
            </section>

            <section>
                <h3 class="major">Buttons</h3>
                <ul class="actions">
                    <li><a class="button primary" href="#">Primary</a></li>
                    <li><a class="button" href="#">Default</a></li>
                </ul>
                <ul class="actions">
                    <li><a class="button" href="#">Default</a></li>
                    <li><a class="button small" href="#">Small</a></li>
                </ul>
                <ul class="actions">
                    <li><a class="button primary icon solid fa-download" href="#">Icon</a></li>
                    <li><a class="button icon solid fa-download" href="#">Icon</a></li>
                </ul>
                <ul class="actions">
                    <li><span class="button primary disabled">Disabled</span></li>
                    <li><span class="button disabled">Disabled</span></li>
                </ul>
            </section>

            <section>
                <h3 class="major">Form</h3>
                <form action="#" method="post">
                    <div class="fields">
                        <div class="field half">
                            <label for="demo-name">Name</label>
                            <input id="demo-name" name="demo-name" placeholder="Jane Doe" type="text" value=""/>
                        </div>
                        <div class="field half">
                            <label for="demo-email">Email</label>
                            <input id="demo-email" name="demo-email" placeholder="jane@untitled.tld" type="email"
                                   value=""/>
                        </div>
                        <div class="field">
                            <label for="demo-category">Category</label>
                            <select id="demo-category" name="demo-category">
                                <option value="">-</option>
                                <option value="1">Manufacturing</option>
                                <option value="1">Shipping</option>
                                <option value="1">Administration</option>
                                <option value="1">Human Resources</option>
                            </select>
                        </div>
                        <div class="field half">
                            <input checked id="demo-priority-low" name="demo-priority" type="radio">
                            <label for="demo-priority-low">Low</label>
                        </div>
                        <div class="field half">
                            <input id="demo-priority-high" name="demo-priority" type="radio">
                            <label for="demo-priority-high">High</label>
                        </div>
                        <div class="field half">
                            <input id="demo-copy" name="demo-copy" type="checkbox">
                            <label for="demo-copy">Email me a copy</label>
                        </div>
                        <div class="field half">
                            <input checked id="demo-human" name="demo-human" type="checkbox">
                            <label for="demo-human">Not a robot</label>
                        </div>
                        <div class="field">
                            <label for="demo-message">Message</label>
                            <textarea id="demo-message" name="demo-message" placeholder="Enter your message"
                                      rows="6"></textarea>
                        </div>
                    </div>
                    <ul class="actions">
                        <li><input class="primary" type="submit" value="Send Message"/></li>
                        <li><input type="reset" value="Reset"/></li>
                    </ul>
                </form>
            </section>

        </article>

    </div>

    <!-- Footer -->
    <footer id="footer">
		<p class="copyright">&copy; Contact: <a href="#contact">Adam and James</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.<br /><br /> Image: <a href="https://www.astrophemeris.es">www.astrophemeris.es</a> </p>
    </footer>

</div>

<!-- BG -->
<div id="bg"></div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>

</body>
</html>
